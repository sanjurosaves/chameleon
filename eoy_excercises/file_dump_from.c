#include <stdio.h>
#include <math.h>
#include <string.h>

int main()
{
	FILE *fptr, *pcm;
	int i, l, r, ldif = 0, rdif = 0, snum;
	short int n[368] = { 0xFDFF, 0xFEFF, 0xFEFF, 0x0100, 0xFCFF, 0xFEFF, 0x0400, 0x0100, 0xFBFF, 0x0200, 0x0200, 0xFCFF, 0xF9FF, 0x0100, 0x0200, 0xFDFF, 0xF9FF, 0x0100, 0x0200, 0xFEFF, 0xFDFF, 0x0200, 0x0400, 0x0100, 0xFCFF, 0xFDFF, 0xFEFF, 0x0400, 0x0100, 0xFBFF, 0xFDFF, 0x0400, 0xFDFF, 0xFDFF, 0x0100, 0x0100, 0xFDFF, 0xFBFF, 0xFEFF, 0x0100, 0x0000, 0xFEFF, 0x0000, 0x0000, 0xFBFF, 0x0000, 0x0500, 0xFEFF, 0xFDFF, 0x0100, 0x0200, 0xFDFF, 0xFCFF, 0xFEFF, 0x0500, 0xFDFF, 0xFCFF, 0x0100, 0x0100, 0xFEFF, 0xFEFF, 0xFEFF, 0x0200, 0x0100, 0xFCFF, 0xFCFF, 0x0100, 0x0200, 0xFEFF, 0xF9FF, 0xFDFF, 0x0200, 0x0100, 0xFEFF, 0xFEFF, 0xFEFF, 0xFDFF, 0x0100, 0x0100, 0xFEFF, 0xFCFF, 0x0400, 0x0200, 0xFDFF, 0xFBFF, 0x0100, 0x0100, 0xFCFF, 0xFDFF, 0x0200, 0x0100, 0x0100, 0xFDFF, 0xFDFF, 0x0500, 0x0100, 0xFDFF, 0x0100, 0x0100, 0xFDFF, 0xFDFF, 0x0200, 0x0000, 0x0000, 0x0000, 0x0000, 0xFEFF, 0xFCFF, 0x0000, 0x0200, 0xFEFF, 0xFDFF, 0x0100, 0x0100, 0xFDFF, 0x0100, 0x0000, 0x0000, 0xFEFF, 0x0000, 0xFEFF, 0xFCFF, 0x0400, 0x0400, 0xF9FF, 0xFEFF, 0x0500, 0x0200, 0xF9FF, 0xFCFF, 0x0500, 0x0000, 0xFBFF, 0x0000, 0x0200, 0x0100, 0x0100, 0xFEFF, 0xFCFF, 0x0000, 0x0400, 0x0000, 0xFDFF, 0xFEFF, 0x0100, 0x0400, 0xFDFF, 0xFCFF, 0x0400, 0x0000, 0xFEFF, 0xFEFF, 0xFEFF, 0x0200, 0x0100, 0xFDFF, 0x0100, 0x0100, 0x0000, 0xFEFF, 0xFEFF, 0x0100, 0xFCFF, 0xFDFF, 0x0200, 0x0200, 0xFDFF, 0xFDFF, 0x0100, 0x0200, 0xFDFF, 0x0000, 0x0500, 0x0200, 0xFCFF, 0x0100, 0x0400, 0x0000, 0xFDFF, 0x0400, 0x0200, 0xFDFF, 0xFCFF, 0x0200, 0x0500, 0xFCFF, 0xFCFF, 0x0500, 0x0200, 0xFDFF, 0xFCFF, 0x0400, 0x0200, 0x0000, 0xFDFF, 0x0100, 0x0400, 0x0200, 0xFEFF, 0xFEFF, 0x0000, 0x0400, 0x0100, 0xFDFF, 0xFEFF, 0x0500, 0x0200, 0xFDFF, 0xFEFF, 0x0500, 0x0100, 0xFDFF, 0x0000, 0x0400, 0x0000, 0xFBFF, 0x0000, 0x0400, 0xFEFF, 0xFCFF, 0x0000, 0x0200, 0x0200, 0x0000, 0xFEFF, 0x0000, 0xFEFF, 0xFDFF, 0x0000, 0x0100, 0x0100, 0x0100, 0xFEFF, 0xFDFF, 0xFCFF, 0x0000, 0x0000, 0xFEFF, 0xFBFF, 0x0000, 0x0100, 0x0000, 0xFBFF, 0xFCFF, 0x0400, 0x0000, 0xFDFF, 0xFCFF, 0x0000, 0x0000, 0x0000, 0x0100, 0x0000, 0xFDFF, 0x0000, 0x0400, 0xFDFF, 0xFBFF, 0x0600, 0x0500, 0xF8FF, 0xF9FF, 0x0500, 0x0500, 0xFEFF, 0xFCFF, 0xFDFF, 0x0100, 0x0000, 0x0000, 0xF9FF, 0xFEFF, 0x0200, 0x0500, 0xF9FF, 0xFCFF, 0x0000, 0x0500, 0x0000, 0xF9FF, 0xFCFF, 0x0200, 0x0000, 0xFEFF, 0xFDFF, 0x0400, 0x0100, 0x0000, 0xFDFF, 0xFEFF, 0x0100, 0xFEFF, 0xFCFF, 0xFEFF, 0x0200, 0x0100, 0x0000, 0xFDFF, 0x0100, 0xFEFF, 0x0000, 0x0100, 0x0100, 0x0100, 0xFDFF, 0x0100, 0x0000, 0xFDFF, 0x0000, 0x0100, 0xFCFF, 0xFDFF, 0x0200, 0x0100, 0x0000, 0xFEFF, 0x0000, 0x0000, 0x0000, 0x0000, 0xFCFF, 0xFCFF, 0x0200, 0x0400, 0xFCFF, 0xFBFF, 0x0200, 0x0200, 0xFEFF, 0xFCFF, 0xFBFF, 0x0200, 0x0200, 0xFBFF, 0xFCFF, 0x0400, 0x0700, 0x0000, 0xFCFF, 0x0000, 0xFEFF, 0x0100, 0xFEFF, 0xFBFF, 0x0100, 0x0200, 0x0000, 0xFBFF, 0x0100, 0x0100, 0xFEFF, 0xFCFF, 0x0000, 0xFEFF, 0xFDFF, 0xFEFF, 0x0500, 0xFDFF, 0xFDFF, 0x0100, 0x0000, 0xFEFF, 0xFEFF, 0xFDFF, 0x8000, 0x8000, 0x7FFF, 0x7FFF };
	short int sample;
	fptr = fopen("output.csv", "w");
	pcm = fopen("zebraPCMle.pcm", "rb");
	if (pcm == NULL)
	{
		printf("Error opening file\n");
		return 1;
	}

	fprintf(fptr, "sample #, left val, dist from prev left val, right val, dist from prev rval\n");
	for (i = 0; i < 368; i++)
	{
		if (i % 2 == 0)
		{
			if (i != 0)
				ldif = n[i] - n[i - 2];
			snum = i / 2;
			l = n[i];
		}
		else
		{
			if (i != 1)
				rdif = n[i] - n[i - 2];
			r = n[i];
			fprintf(fptr, "%d, %d, %d, %d, %d\n", snum, l, ldif, r, rdif);
		}
	}

	for (i = 0; i < 16; i++)
	{
		char a = fgetc(pcm);
		/* printf("a: %02X\n", a); */
		char b = fgetc(pcm);
		/* printf("b: %02X\n", b); */
		short int shifteda = (((short)a) << 8);
		/* printf("shifteda: %X\n", shifteda); */
		sample = shifteda | (0x00ff & b);

		printf("sample: %d\n", sample);
/*		if (i % 2 != 0)
			printf("\n");
*/
	}
	fclose(fptr);
	fclose(pcm);
	return 0;
}
